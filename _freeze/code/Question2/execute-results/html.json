{
  "hash": "44c0fa42db9259935a44aa4c0d6a9a2a",
  "result": {
    "markdown": "---\ntitle: \"Question 2\"\nauthor: \"Kiana Fields\"\ndate: \"2024-03-08\"\noutput: pdf_document\n---\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pollutant data stuff/wrangling\npollutants_pdx <- pollutants_pdx %>%\n  rename(NO2 = \"Daily Max 1-hour NO2 Concentration\",\n         Ozone = \"Daily Max 8-hour Ozone Concentration\",\n         CO = \"Daily Max 8-hour CO Concentration\",\n         SO2 = \"Daily Max 1-hour SO2 Concentration\",\n         PM2.5 = \"Daily Mean PM2.5 Concentration\",\n         AQI = \"DAILY_AQI_VALUE\",\n         )\n\npollutants_pdx_melt <- pollutants_pdx %>%\n  pivot_longer(cols = c(NO2, CO, SO2, PM2.5, Ozone, AQI),\n               names_to = \"variable\",\n               values_to = \"reading\") %>%\n  filter(!is.na(reading))\n\npollutants_pdx_melt <- pollutants_pdx_melt %>% \n  filter(variable == \"PM2.5\" | \n           variable == \"NO2\" | \n           variable == \"Ozone\" | \n           variable == \"AQI\")\n\npollutants_pdx_melt$Date <- mdy(pollutants_pdx_melt$Date)\n\npollutants_pdx_melt <- pollutants_pdx_melt %>% \n  group_by(Date, variable) %>% \n  summarise(avrg_reading = mean(reading, na.rm = TRUE)) %>% \n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'Date'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\npollutants_pdx_melt <- pollutants_pdx_melt %>%\n  mutate(year = year(Date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Is there a correlation between wildfire season and air quality fluctuations in the Portland Metropolitan area?\n\n#INTRO: \n#The intensity of Oregon's wildfire season in Oregon has increased over time as a result of historical forest management as well as climate change effects. The intensity of these fires is of concern to public safety both immediately in fire prone areas as well as for communities facing decreased air quality from smoke. We are interested in exploring this aspect of the issue of wildfires by analyzing concentration levels of major pollutants produced by wildfires (particularly PM2.5, NO2, Ozone and general AQI) before during and after fire season. \n\n#Approach:\n#Our assumption is that during wildfire season, more pollutants are emitted into the atmosphere, meaning that from mid-May to September pollutant concentrations will go up. We used six years from our pollutant dataset which offers pollutant concentration by day as well as in a more succinct format with the first, 15th, and last day of the month. We also pulled in our fire dataset which offers the total protected acres burned by day across the six years in order to differentiate between general seasonal fluctuations and the actual severity of wildfire season across years.\n#Julian's graph\n#In our first graph, we focused on the concentration of carbon monoxide across years since this is one of the most prominent pollutants associated with wildfires. This data was visualized by a column graph where each column is a month, sectioned by color and year, with markers indicating the standard wildfire seasons.\n\n# Our second graph considers other pollutant levels over each year from 2017-2023 in order to consider overall trends in pollutant concentration fluctuation. It is presented alongside wildfire data in order to consider to what extent the fluctuation is impacted by wildfire season. This is done with a series of line graphs. These plots help to better visualize the relationship between wildfires and air pollution which aligns with our primary goal.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#graphing fires\n#considering changing severity of fire seasons over years\nggplot(data = fires_full, aes(x=ReportDate, y = tot_ProAcres)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](Question2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfires_full <- fires_full %>%\n  mutate(year = year(ReportDate))\n\nggplot(data = fires_full, aes(x=ReportDate, y = tot_ProAcres)) +\n  geom_line() +\n  facet_wrap(~year, scales = \"free_x\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size=5))\n```\n\n::: {.cell-output-display}\n![](Question2_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# In the proposal we said we'd plot observations for the first, 15th, and last day of each month across one year, and observe whether there is a stark increase in pollutant concentrations during the wildfire season (July-September) and have multiple lines to see which pollutants in particular increase. \n#instead of separate lines, separate graphs for unit/interpretating reasons\n#but yeah this is that from the proposal\n\n#data for first 15th and last day of month\npollutants_FML <- pollutants_pdx_melt %>%\n  mutate(day = day(Date)) %>%\n  filter(day == 1 | day == 15 | day == max(day)) %>%\n  select(-day)  \n\n#2017, considering trends in just one year, can be altered for whichever year\nggplot(pollutants_FML %>% \n         filter(year == 2017), aes(x = Date, y = avrg_reading, color = variable)) +\n  geom_line() +\n  facet_wrap(~ variable + year, scales = \"free\") +\n  labs(title = \"Observations for First, 15th, and Last Day of Each Month\",\n       x = \"Date\", \n       y = \"Reading\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1, size=5))\n```\n\n::: {.cell-output-display}\n![](Question2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#on one super mega huge giant ggplot to see how this holds up across years\nggplot(pollutants_FML, aes(x = Date, y = avrg_reading, color = variable)) +\n  geom_line() +\n  facet_wrap(~ variable + year, scales = \"free\") +\n  labs(title = \"Observations for First, 15th, and Last Day of Each Month\",\n       x = \"Date\", y = \"Reading\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1, size=5))\n```\n\n::: {.cell-output-display}\n![](Question2_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#this could be graph 2\n#uhhhh this is a visualization with all the pollutants over all the years compared to wildfires\n#Its a little yucky but shows a seasonal pattern of fluctuation in pollutant levels thats pretty clear (esp for NO2 and Ozone). It also supports the wow 2020 was weird findings from other graphs\n#this chunk also has this same thing but specific years (2019, 2020, and 2021) to kind of look a little more into 2020 by comparing with these other times\n\naqi_plot <- ggplot(data=pollutants_pdx_melt %>% \n                     filter(variable == \"AQI\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"Air Quality Index\"),\n         x = \"Date\", y = \"AQI\")\nNO2_plot <- ggplot(data=pollutants_pdx_melt %>% \n                     filter(variable == \"NO2\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"NO2\"),\n         x = \"Date\", y = \"ppb\")\nozone_plot <- ggplot(data=pollutants_pdx_melt %>% \n                     filter(variable == \"Ozone\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"Ozone\"),\n         x = \"Date\", y = \"ppm\")\npm2.5_plot <- ggplot(data=pollutants_pdx_melt %>% \n                     filter(variable == \"PM2.5\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"PM2.5\"),\n         x = \"Date\", y = \"ug/m3\")\nfire_plot <- ggplot(data = fires_full, aes(x = ReportDate, y = tot_ProAcres)) +\n  geom_line(color = \"red\") +\n  labs(title = \"Total Protected Acres Burnt\",\n       x = \"Date\", y = \"Acres Burnt\")\narranged_plots <- plot_grid(fire_plot,\n                             aqi_plot, \n                             pm2.5_plot,\n                             NO2_plot, \n                             ozone_plot, \n                             ncol = 1, \n                             align = \"v\", \n                             rel_heights = c(1, rep(1, 4)),\n                             hjust = -1,\n                             vjust = 1)\narranged_plots\n```\n\n::: {.cell-output-display}\n![](Question2_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#this is that same nonsense but just for 2020:\npollutants20 <- pollutants_pdx_melt %>% \n  filter(year == \"2020\")\naqi_plot20 <- ggplot(data=pollutants20 %>% \n                     filter(variable == \"AQI\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"Air Quality Index\"),\n         x = \"Date\", y = \"AQI\")\nNO2_plot20 <- ggplot(data=pollutants20 %>% \n                     filter(variable == \"NO2\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"NO2\"),\n         x = \"Date\", y = \"ppb\")\nozone_plot20 <- ggplot(data=pollutants20 %>% \n                     filter(variable == \"Ozone\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"Ozone\"),\n         x = \"Date\", y = \"ppm\")\npm2.5_plot20 <- ggplot(data=pollutants20 %>% \n                     filter(variable == \"PM2.5\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"PM2.5\"),\n         x = \"Date\", y = \"ug/m3\")\nfire_plot20 <- ggplot(data = fires_full %>% \n                        filter(year == \"2020\"), aes(x = ReportDate, y = tot_ProAcres)) +\n  geom_line(color = \"red\") +\n  labs(title = \"Total Protected Acres Burnt\",\n       x = \"Date\", y = \"Acres Burnt\")\narranged_plots20 <- plot_grid(fire_plot20,\n                             aqi_plot20, \n                             pm2.5_plot20,\n                             NO2_plot20, \n                             ozone_plot20, \n                             ncol = 1, \n                             align = \"v\", \n                             rel_heights = c(1, rep(1, 4)),\n                             hjust = -1,\n                             vjust = 1)\narranged_plots20\n```\n\n::: {.cell-output-display}\n![](Question2_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#aaaaannd for 2021\npollutants21 <- pollutants_pdx_melt %>% \n  filter(year == \"2021\")\naqi_plot21 <- ggplot(data=pollutants21 %>% \n                     filter(variable == \"AQI\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"Air Quality Index\"),\n         x = \"Date\", y = \"AQI\")\nNO2_plot21 <- ggplot(data=pollutants21 %>% \n                     filter(variable == \"NO2\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"NO2\"),\n         x = \"Date\", y = \"ppb\")\nozone_plot21 <- ggplot(data=pollutants21 %>% \n                     filter(variable == \"Ozone\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"Ozone\"),\n         x = \"Date\", y = \"ppm\")\npm2.5_plot21 <- ggplot(data=pollutants21 %>% \n                     filter(variable == \"PM2.5\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"PM2.5\"),\n         x = \"Date\", y = \"ug/m3\")\nfire_plot21 <- ggplot(data = fires_full %>% \n                      filter(year == \"2021\"), aes(x = ReportDate, y = tot_ProAcres)) +\n  geom_line(color = \"red\") +\n  labs(title = \"Total Protected Acres Burnt\",\n       x = \"Date\", y = \"Acres Burnt\")\narranged_plots21 <- plot_grid(fire_plot21,\n                             aqi_plot21, \n                             pm2.5_plot21,\n                             NO2_plot21, \n                             ozone_plot21, \n                             ncol = 1, \n                             align = \"v\", \n                             rel_heights = c(1, rep(1, 4)),\n                             hjust = -1,\n                             vjust = 1)\narranged_plots21\n```\n\n::: {.cell-output-display}\n![](Question2_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#aaaand 2019\npollutants19 <- pollutants_pdx_melt %>% \n  filter(year == \"2019\")\naqi_plot19 <- ggplot(data=pollutants19 %>% \n                     filter(variable == \"AQI\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"Air Quality Index\"),\n         x = \"Date\", y = \"AQI\")\nNO2_plot19 <- ggplot(data=pollutants19 %>% \n                     filter(variable == \"NO2\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"NO2\"),\n         x = \"Date\", y = \"ppb\")\nozone_plot19 <- ggplot(data=pollutants19 %>% \n                     filter(variable == \"Ozone\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"Ozone\"),\n         x = \"Date\", y = \"ppm\")\npm2.5_plot19 <- ggplot(data=pollutants19 %>% \n                     filter(variable == \"PM2.5\"), aes(x=Date, y=avrg_reading)) +\n  geom_line() +\n  labs(title = paste(\"PM2.5\"),\n         x = \"Date\", y = \"ug/m3\")\nfire_plot19 <- ggplot(data = fires_full %>% \n                      filter(year == \"2019\"), aes(x = ReportDate, y = tot_ProAcres)) +\n  geom_line(color = \"red\") +\n  labs(title = \"Total Protected Acres Burnt\",\n       x = \"Date\", y = \"Acres Burnt\")\narranged_plots19 <- plot_grid(fire_plot19,\n                             aqi_plot19, \n                             pm2.5_plot19,\n                             NO2_plot19, \n                             ozone_plot19, \n                             ncol = 1, \n                             align = \"v\", \n                             rel_heights = c(1, rep(1, 4)),\n                             hjust = -1,\n                             vjust = 1)\narranged_plots19\n```\n\n::: {.cell-output-display}\n![](Question2_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#summary statistics\n#correlation across all years\n\npollutant_agg <- pollutants_pdx_melt %>%\n  group_by(Date, variable) %>%\n  summarise(avrg_reading = mean(avrg_reading, na.rm = TRUE)) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'Date'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nfires_agg <- fires_full %>%\n  group_by(ReportDate) %>%\n  summarise(tot_ProAcres = sum(tot_ProAcres, na.rm = TRUE)) %>%\n  ungroup()\n\nmerged_data <- merge(pollutant_agg, fires_agg, by.x = \"Date\", by.y = \"ReportDate\", all = TRUE)\n\ncorrelations <- lapply(unique(merged_data$variable), function(var) {\n  pollutant_data <- merged_data %>%\n    filter(variable == var)\n  correlation <- cor.test(pollutant_data$avrg_reading, pollutant_data$tot_ProAcres)$estimate\n  data.frame(Pollutant = var, Correlation = correlation)\n})\n\ncorrelations_df <- do.call(rbind, correlations)\n\nprint(correlations_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Pollutant Correlation\ncor        AQI  0.03593917\ncor1       NO2 -0.04404681\ncor2     Ozone  0.07618129\ncor3     PM2.5  0.01302626\n```\n:::\n\n```{.r .cell-code}\n#correlation coefficients seperate for each year (some years there appears to be more of a correlation)\n\npollutant_agg <- pollutants_pdx_melt %>%\n  group_by(Date, variable) %>%\n  summarise(avrg_reading = mean(avrg_reading, na.rm = TRUE)) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'Date'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nfires_agg <- fires_full %>%\n  group_by(ReportDate) %>%\n  summarise(tot_ProAcres = sum(tot_ProAcres, na.rm = TRUE)) %>%\n  ungroup()\n\nmerged_data <- merge(pollutant_agg, fires_agg, by.x = \"Date\", by.y = \"ReportDate\", all = TRUE)\n\nyears <- unique(year(merged_data$Date))\ncorrelations <- lapply(years, function(yr) {\n  merged_data_year <- merged_data %>%\n    filter(year(Date) == yr)\n  lapply(unique(merged_data_year$variable), function(var) {\n    pollutant_data <- merged_data_year %>%\n      filter(variable == var)\n    correlation <- cor.test(pollutant_data$avrg_reading, pollutant_data$tot_ProAcres)$estimate\n    data.frame(Year = yr, Pollutant = var, Correlation = correlation)\n  })\n})\ncorrelations_df <- do.call(rbind, do.call(c, correlations))\n\nprint(correlations_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Year Pollutant  Correlation\ncor   2017       AQI  0.003493451\ncor1  2017       NO2 -0.057383806\ncor2  2017     Ozone  0.092799238\ncor3  2017     PM2.5 -0.016710326\ncor4  2018       AQI  0.161598365\ncor5  2018       NO2 -0.005166186\ncor6  2018     Ozone  0.227587120\ncor7  2018     PM2.5  0.120739501\ncor8  2019       AQI -0.026570145\ncor9  2019       NO2 -0.021680720\ncor10 2019     Ozone  0.048878287\ncor11 2019     PM2.5 -0.041051857\ncor12 2020       AQI  0.036674509\ncor13 2020       NO2 -0.067982067\ncor14 2020     Ozone  0.152208024\ncor15 2020     PM2.5  0.006017456\ncor16 2021       AQI  0.026607009\ncor17 2021       NO2 -0.059376745\ncor18 2021     Ozone  0.046731816\ncor19 2021     PM2.5  0.011418891\ncor20 2022       AQI  0.067481058\ncor21 2022       NO2  0.023723032\ncor22 2022     Ozone  0.212283660\ncor23 2022     PM2.5 -0.006286033\n```\n:::\n:::\n",
    "supporting": [
      "Question2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}