---
title: "data_cleanup"
output: pdf_document
date: "2024-02-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library loading, include = FALSE}
library(readr)
library(dplyr)
```

```{r data loading, include = FALSE}
# loading all epa data csv locally
# you might need to use ctrl F or command F to fix the file directories, but the rest should work perfectly

# pm2.5 data 2017-2023 portland-vancouver-hillsboro (or-wa)

pm25_portland_2023 <- read_csv("~/Github/project01-ojkp/air data/pm25/pm25 portland 2023.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm25_portland_2022 <- read_csv("~/Github/project01-ojkp/air data/pm25/pm25 portland 2022.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm25_portland_2021 <- read_csv("~/Github/project01-ojkp/air data/pm25/pm25 portland 2021.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm25_portland_2020 <- read_csv("~/Github/project01-ojkp/air data/pm25/pm25 portland 2020.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm25_portland_2019 <- read_csv("~/Github/project01-ojkp/air data/pm25/pm25 portland 2019.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm25_portland_2018 <- read_csv("~/Github/project01-ojkp/air data/pm25/pm25 portland 2018.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm25_portland_2017 <- read_csv("~/Github/project01-ojkp/air data/pm25/pm25 portland 2017.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))

# pm10 data 2017-2023 portland-vancouver-hillsboro (or-wa)
pm10_portland_2023 <- read_csv("~/Github/project01-ojkp/air data/pm10/pm10 portland 2023.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm10_portland_2022 <- read_csv("~/Github/project01-ojkp/air data/pm10/pm10 portland 2022.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm10_portland_2021 <- read_csv("~/Github/project01-ojkp/air data/pm10/pm10 portland 2021.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm10_portland_2020 <- read_csv("~/Github/project01-ojkp/air data/pm10/pm10 portland 2020.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm10_portland_2019 <- read_csv("~/Github/project01-ojkp/air data/pm10/pm10 portland 2019.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm10_portland_2018 <- read_csv("~/Github/project01-ojkp/air data/pm10/pm10 portland 2018.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))
pm10_portland_2017 <- read_csv("~/Github/project01-ojkp/air data/pm10/pm10 portland 2017.csv", 
                               col_types = cols(Date = col_date(format = "%m/%d/%Y")))

# co data 2017-2023 portland-vancouver-hillsboro (or-wa)
co_portland_2023 <- read_csv("~/Github/project01-ojkp/air data/co/co portland 2023.csv", 
                             col_types = cols(Date = col_date(format = "%m/%d/%Y")))
co_portland_2022 <- read_csv("~/Github/project01-ojkp/air data/co/co portland 2022.csv", 
                             col_types = cols(Date = col_date(format = "%m/%d/%Y")))
co_portland_2021 <- read_csv("~/Github/project01-ojkp/air data/co/co portland 2021.csv", 
                             col_types = cols(Date = col_date(format = "%m/%d/%Y")))
co_portland_2020 <- read_csv("~/Github/project01-ojkp/air data/co/co portland 2020.csv", 
                             col_types = cols(Date = col_date(format = "%m/%d/%Y")))
co_portland_2019 <- read_csv("~/Github/project01-ojkp/air data/co/co portland 2019.csv", 
                             col_types = cols(Date = col_date(format = "%m/%d/%Y")))
co_portland_2018 <- read_csv("~/Github/project01-ojkp/air data/co/co portland 2018.csv", 
                             col_types = cols(Date = col_date(format = "%m/%d/%Y")))
co_portland_2017 <- read_csv("~/Github/project01-ojkp/air data/co/co portland 2017.csv", 
                             col_types = cols(Date = col_date(format = "%m/%d/%Y")))

# no2 data 2017-2023 portland-vancouver-hillsboro (or-wa)
no2_portland_2023 <- read_csv("~/Github/project01-ojkp/air data/no2/no2 portland 2023.csv", 
                              col_types = cols(Date = col_date(format = "%m/%d/%Y")))
no2_portland_2022 <- read_csv("~/Github/project01-ojkp/air data/no2/no2 portland 2022.csv", 
                              col_types = cols(Date = col_date(format = "%m/%d/%Y")))
no2_portland_2021 <- read_csv("~/Github/project01-ojkp/air data/no2/no2 portland 2021.csv", 
                              col_types = cols(Date = col_date(format = "%m/%d/%Y")))
no2_portland_2020 <- read_csv("~/Github/project01-ojkp/air data/no2/no2 portland 2020.csv", 
                              col_types = cols(Date = col_date(format = "%m/%d/%Y")))
no2_portland_2019 <- read_csv("~/Github/project01-ojkp/air data/no2/no2 portland 2019.csv", 
                              col_types = cols(Date = col_date(format = "%m/%d/%Y")))
no2_portland_2018 <- read_csv("~/Github/project01-ojkp/air data/no2/no2 portland 2018.csv", 
                              col_types = cols(Date = col_date(format = "%m/%d/%Y")))
no2_portland_2017 <- read_csv("~/Github/project01-ojkp/air data/no2/no2 portland 2017.csv", 
                              col_types = cols(Date = col_date(format = "%m/%d/%Y")))

# ozone data 2017-2023 portland-vancouver-hillsboro (or-wa)
ozone_portland_2023 <- read_csv("~/Github/project01-ojkp/air data/ozone/ozone portland 2023.csv", 
                                col_types = cols(Date = col_date(format = "%m/%d/%Y")))
ozone_portland_2022 <- read_csv("~/Github/project01-ojkp/air data/ozone/ozone portland 2022.csv", 
                                col_types = cols(Date = col_date(format = "%m/%d/%Y")))
ozone_portland_2021 <- read_csv("~/Github/project01-ojkp/air data/ozone/ozone portland 2021.csv", 
                                col_types = cols(Date = col_date(format = "%m/%d/%Y")))
ozone_portland_2020 <- read_csv("~/Github/project01-ojkp/air data/ozone/ozone portland 2020.csv", 
                                col_types = cols(Date = col_date(format = "%m/%d/%Y")))
ozone_portland_2019 <- read_csv("~/Github/project01-ojkp/air data/ozone/ozone portland 2019.csv", 
                                col_types = cols(Date = col_date(format = "%m/%d/%Y")))
ozone_portland_2018 <- read_csv("~/Github/project01-ojkp/air data/ozone/ozone portland 2018.csv", 
                                col_types = cols(Date = col_date(format = "%m/%d/%Y")))
ozone_portland_2017 <- read_csv("~/Github/project01-ojkp/air data/ozone/ozone portland 2017.csv", 
                                col_types = cols(Date = col_date(format = "%m/%d/%Y")))


```


```{r data merging and wrangling, include = FALSE}
# average pm2.5 per month 2017-2023

pm25_portland_2023$month_year <- format(pm25_portland_2023$Date, "%Y-%m")
pm25_portland_2022$month_year <- format(pm25_portland_2022$Date, "%Y-%m")
pm25_portland_2021$month_year <- format(pm25_portland_2021$Date, "%Y-%m")
pm25_portland_2020$month_year <- format(pm25_portland_2020$Date, "%Y-%m")
pm25_portland_2019$month_year <- format(pm25_portland_2019$Date, "%Y-%m")
pm25_portland_2018$month_year <- format(pm25_portland_2018$Date, "%Y-%m")
pm25_portland_2017$month_year <- format(pm25_portland_2017$Date, "%Y-%m")

avg_pm25_2023 <- pm25_portland_2023 %>%
  group_by(month_year) %>%
  summarize(avg_pm2.5 = mean(`Daily Mean PM2.5 Concentration`))

avg_pm25_2022 <- pm25_portland_2022 %>%
  group_by(month_year) %>%
  summarize(avg_pm2.5 = mean(`Daily Mean PM2.5 Concentration`))

avg_pm25_2021 <- pm25_portland_2021 %>%
  group_by(month_year) %>%
  summarize(avg_pm2.5 = mean(`Daily Mean PM2.5 Concentration`))

avg_pm25_2020 <- pm25_portland_2020 %>%
  group_by(month_year) %>%
  summarize(avg_pm2.5 = mean(`Daily Mean PM2.5 Concentration`))

avg_pm25_2019 <- pm25_portland_2019 %>%
  group_by(month_year) %>%
  summarize(avg_pm2.5 = mean(`Daily Mean PM2.5 Concentration`))

avg_pm25_2018 <- pm25_portland_2018 %>%
  group_by(month_year) %>%
  summarize(avg_pm2.5 = mean(`Daily Mean PM2.5 Concentration`))

avg_pm25_2017 <- pm25_portland_2017 %>%
  group_by(month_year) %>%
  summarize(avg_pm2.5 = mean(`Daily Mean PM2.5 Concentration`))

avg_pm25 <- bind_rows(avg_pm25_2017, avg_pm25_2018, avg_pm25_2019, avg_pm25_2020, avg_pm25_2021, avg_pm25_2022, avg_pm25_2023)
rm(avg_pm25_2017, avg_pm25_2018, avg_pm25_2019, avg_pm25_2020, avg_pm25_2021, avg_pm25_2022, avg_pm25_2023)


# average pm10 per month 2017-2023

pm10_portland_2023$month_year <- format(pm10_portland_2023$Date, "%Y-%m")
pm10_portland_2022$month_year <- format(pm10_portland_2022$Date, "%Y-%m")
pm10_portland_2021$month_year <- format(pm10_portland_2021$Date, "%Y-%m")
pm10_portland_2020$month_year <- format(pm10_portland_2020$Date, "%Y-%m")
pm10_portland_2019$month_year <- format(pm10_portland_2019$Date, "%Y-%m")
pm10_portland_2018$month_year <- format(pm10_portland_2018$Date, "%Y-%m")
pm10_portland_2017$month_year <- format(pm10_portland_2017$Date, "%Y-%m")

avg_pm10_2023 <- pm10_portland_2023 %>%
  group_by(month_year) %>%
  summarize(avg_pm10 = mean(`Daily Mean PM10 Concentration`))

avg_pm10_2022 <- pm10_portland_2022 %>%
  group_by(month_year) %>%
  summarize(avg_pm10 = mean(`Daily Mean PM10 Concentration`))

avg_pm10_2021 <- pm10_portland_2021 %>%
  group_by(month_year) %>%
  summarize(avg_pm10 = mean(`Daily Mean PM10 Concentration`))

avg_pm10_2020 <- pm10_portland_2020 %>%
  group_by(month_year) %>%
  summarize(avg_pm10 = mean(`Daily Mean PM10 Concentration`))

avg_pm10_2019 <- pm10_portland_2019 %>%
  group_by(month_year) %>%
  summarize(avg_pm10 = mean(`Daily Mean PM10 Concentration`))

avg_pm10_2018 <- pm10_portland_2018 %>%
  group_by(month_year) %>%
  summarize(avg_pm10 = mean(`Daily Mean PM10 Concentration`))

avg_pm10_2017 <- pm10_portland_2017 %>%
  group_by(month_year) %>%
  summarize(avg_pm10 = mean(`Daily Mean PM10 Concentration`))

avg_pm10 <- bind_rows(avg_pm10_2017, avg_pm10_2018, avg_pm10_2019, avg_pm10_2020, avg_pm10_2021, avg_pm10_2022, avg_pm10_2023)
rm(avg_pm10_2017, avg_pm10_2018, avg_pm10_2019, avg_pm10_2020, avg_pm10_2021, avg_pm10_2022, avg_pm10_2023)


# average co per month 2017-2023

co_portland_2023$month_year <- format(co_portland_2023$Date, "%Y-%m")
co_portland_2022$month_year <- format(co_portland_2022$Date, "%Y-%m")
co_portland_2021$month_year <- format(co_portland_2021$Date, "%Y-%m")
co_portland_2020$month_year <- format(co_portland_2020$Date, "%Y-%m")
co_portland_2019$month_year <- format(co_portland_2019$Date, "%Y-%m")
co_portland_2018$month_year <- format(co_portland_2018$Date, "%Y-%m")
co_portland_2017$month_year <- format(co_portland_2017$Date, "%Y-%m")

avg_co_2023 <- co_portland_2023 %>%
  group_by(month_year) %>%
  summarize(avg_co = mean(`Daily Max 8-hour CO Concentration`))

avg_co_2022 <- co_portland_2022 %>%
  group_by(month_year) %>%
  summarize(avg_co = mean(`Daily Max 8-hour CO Concentration`))

avg_co_2021 <- co_portland_2021 %>%
  group_by(month_year) %>%
  summarize(avg_co = mean(`Daily Max 8-hour CO Concentration`))

avg_co_2020 <- co_portland_2020 %>%
  group_by(month_year) %>%
  summarize(avg_co = mean(`Daily Max 8-hour CO Concentration`))

avg_co_2019 <- co_portland_2019 %>%
  group_by(month_year) %>%
  summarize(avg_co = mean(`Daily Max 8-hour CO Concentration`))

avg_co_2018 <- co_portland_2018 %>%
  group_by(month_year) %>%
  summarize(avg_co = mean(`Daily Max 8-hour CO Concentration`))

avg_co_2017 <- co_portland_2017 %>%
  group_by(month_year) %>%
  summarize(avg_co = mean(`Daily Max 8-hour CO Concentration`))

avg_co <- bind_rows(avg_co_2017, avg_co_2018, avg_co_2019, avg_co_2020, avg_co_2021, avg_co_2022, avg_co_2023)
rm(avg_co_2017, avg_co_2018, avg_co_2019, avg_co_2020, avg_co_2021, avg_co_2022, avg_co_2023)


# average no2 per month 2017-2023

no2_portland_2023$month_year <- format(no2_portland_2023$Date, "%Y-%m")
no2_portland_2022$month_year <- format(no2_portland_2022$Date, "%Y-%m")
no2_portland_2021$month_year <- format(no2_portland_2021$Date, "%Y-%m")
no2_portland_2020$month_year <- format(no2_portland_2020$Date, "%Y-%m")
no2_portland_2019$month_year <- format(no2_portland_2019$Date, "%Y-%m")
no2_portland_2018$month_year <- format(no2_portland_2018$Date, "%Y-%m")
no2_portland_2017$month_year <- format(no2_portland_2017$Date, "%Y-%m")

avg_no2_2023 <- no2_portland_2023 %>%
  group_by(month_year) %>%
  summarize(avg_no2 = mean(`Daily Max 1-hour NO2 Concentration`))

avg_no2_2022 <- no2_portland_2022 %>%
  group_by(month_year) %>%
  summarize(avg_no2 = mean(`Daily Max 1-hour NO2 Concentration`))

avg_no2_2021 <- no2_portland_2021 %>%
  group_by(month_year) %>%
  summarize(avg_no2 = mean(`Daily Max 1-hour NO2 Concentration`))

avg_no2_2020 <- no2_portland_2020 %>%
  group_by(month_year) %>%
  summarize(avg_no2 = mean(`Daily Max 1-hour NO2 Concentration`))

avg_no2_2019 <- no2_portland_2019 %>%
  group_by(month_year) %>%
  summarize(avg_no2 = mean(`Daily Max 1-hour NO2 Concentration`))

avg_no2_2018 <- no2_portland_2018 %>%
  group_by(month_year) %>%
  summarize(avg_no2 = mean(`Daily Max 1-hour NO2 Concentration`))

avg_no2_2017 <- no2_portland_2017 %>%
  group_by(month_year) %>%
  summarize(avg_no2 = mean(`Daily Max 1-hour NO2 Concentration`))

avg_no2 <- bind_rows(avg_no2_2017, avg_no2_2018, avg_no2_2019, avg_no2_2020, avg_no2_2021, avg_no2_2022, avg_no2_2023)
rm(avg_no2_2017, avg_no2_2018, avg_no2_2019, avg_no2_2020, avg_no2_2021, avg_no2_2022, avg_no2_2023)


# average ozone per month 2017-2023

ozone_portland_2023$month_year <- format(ozone_portland_2023$Date, "%Y-%m")
ozone_portland_2022$month_year <- format(ozone_portland_2022$Date, "%Y-%m")
ozone_portland_2021$month_year <- format(ozone_portland_2021$Date, "%Y-%m")
ozone_portland_2020$month_year <- format(ozone_portland_2020$Date, "%Y-%m")
ozone_portland_2019$month_year <- format(ozone_portland_2019$Date, "%Y-%m")
ozone_portland_2018$month_year <- format(ozone_portland_2018$Date, "%Y-%m")
ozone_portland_2017$month_year <- format(ozone_portland_2017$Date, "%Y-%m")

avg_ozone_2023 <- ozone_portland_2023 %>%
  group_by(month_year) %>%
  summarize(avg_ozone = mean(`Daily Max 8-hour Ozone Concentration`))

avg_ozone_2022 <- ozone_portland_2022 %>%
  group_by(month_year) %>%
  summarize(avg_ozone = mean(`Daily Max 8-hour Ozone Concentration`))

avg_ozone_2021 <- ozone_portland_2021 %>%
  group_by(month_year) %>%
  summarize(avg_ozone = mean(`Daily Max 8-hour Ozone Concentration`))

avg_ozone_2020 <- ozone_portland_2020 %>%
  group_by(month_year) %>%
  summarize(avg_ozone = mean(`Daily Max 8-hour Ozone Concentration`))

avg_ozone_2019 <- ozone_portland_2019 %>%
  group_by(month_year) %>%
  summarize(avg_ozone = mean(`Daily Max 8-hour Ozone Concentration`))

avg_ozone_2018 <- ozone_portland_2018 %>%
  group_by(month_year) %>%
  summarize(avg_ozone = mean(`Daily Max 8-hour Ozone Concentration`))

avg_ozone_2017 <- ozone_portland_2017 %>%
  group_by(month_year) %>%
  summarize(avg_ozone = mean(`Daily Max 8-hour Ozone Concentration`))

avg_ozone <- bind_rows(avg_ozone_2017, avg_ozone_2018, avg_ozone_2019, avg_ozone_2020, avg_ozone_2021, avg_ozone_2022, avg_ozone_2023)
rm(avg_ozone_2017, avg_ozone_2018, avg_ozone_2019, avg_ozone_2020, avg_ozone_2021, avg_ozone_2022, avg_ozone_2023)
```